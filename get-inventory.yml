---
- hosts: localhost
  gather_facts: true
  tasks:
    - name: "Create a new host"
      uri:
        url: "http://10.128.0.11/api/v2/inventories"
        method: GET
        url_username: admin
        url_password: password
        body_format: json
        validate_certs: false
        force_basic_auth: true
        return_content: yes
        status_code: 200
      register: this
    - set_fact:
        inv_count: "{{ this.json.results | count }}"
    - set_fact:
        inv_names: "{{ query('inventory_hostnames', 'all') }}"
    - debug:
        var: inv_names
        
